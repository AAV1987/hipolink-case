<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Достижения</title>

<link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;700&display=swap" rel="stylesheet">

<style>
    body{
        margin:0;
        padding:30px 10px;
        font-family:'Comfortaa', sans-serif;
        background:transparent;
        color:#fff;
    }

    .wrapper{
        max-width:700px;
        margin:0 auto;
    }

    button.main-toggle{
        background:#a61d45;
        padding:16px;
        text-align:center;
        border-radius:12px;
        cursor:pointer;
        font-size:20px;
        font-weight:700;
        user-select:none;
        border:none;
        width:100%;
        color:white;
        line-height:1.3;
    }

    .main-body{
        overflow:hidden;
        height:0;
        transition:height .35s ease;
        margin-top:12px;
    }

    .case{
        background:rgba(255,255,255,0.05);
        border:1px solid rgba(255,255,255,0.22);
        border-radius:12px;
        padding:14px;
        margin-bottom:12px;
        cursor:pointer;
        position:relative;
    }

    .case-title{
        font-size:17px;
        font-weight:700;
        padding-right:26px;
    }

    .arrow{
        position:absolute;
        right:14px;
        top:50%;
        transform:translateY(-50%);
        transition:.3s;
    }

    .case-content{
        overflow:hidden;
        height:0;
        transition:height .35s ease;
        margin-top:10px;
        font-size:15px;
        line-height:1.55;
    }

    .case.active .arrow{
        transform:translateY(-50%) rotate(180deg);
    }

    .case-content p{
        margin:0 0 10px 0;
    }

    .case-content p:last-child{
        margin-bottom:0;
    }
</style>

</head>
<body>

<div class="wrapper">

    <button class="main-toggle" onclick="toggleMain()">Достижения ▾</button>

    <div id="mainBody" class="main-body" data-open="0">

        <!-- ===== КЕЙСИ ===== -->

        <!-- Кейс 1 -->
        <div class="case" onclick="toggleCase(this)">
            <div class="case-title">Кейс 1. Антикризисный разворот крупного регионального оператора связи</div>
            <div class="arrow">▾</div>
            <div class="case-content" data-open="0">
                <p>Крупный оператор фиксированной и мобильной связи подошёл к моменту кризиса...</p>
                <p>На основе собранных данных я перестроил управленческую модель...</p>
                <p>Работа с персоналом заняла важное место в общей стратегии...</p>
            </div>
        </div>

        <!-- Кейс 2 -->
        <div class="case" onclick="toggleCase(this)">
            <div class="case-title">Кейс 2. Полная легализация и перезапуск сети АЗС</div>
            <div class="arrow">▾</div>
            <div class="case-content" data-open="0">
                <p>Сеть из тринадцати автозаправочных станций...</p>
                <p>Я организовал регистрацию юридических лиц...</p>
                <p>Я переработал операционные процессы и внедрил систему стандартов...</p>
            </div>
        </div>

        <!-- Кейс 3 -->
        <div class="case" onclick="toggleCase(this)">
            <div class="case-title">Кейс 3. Сопровождение инвестиционного проекта</div>
            <div class="arrow">▾</div>
            <div class="case-content" data-open="0">
                <p>Инвестор планировал вложить около ста миллионов рублей...</p>
                <p>Градостроительный блок работ включал проект планировки...</p>
                <p>Первый этап принёс доход около трёх миллионов рублей...</p>
            </div>
        </div>

        <!-- Кейс 4 -->
        <div class="case" onclick="toggleCase(this)">
            <div class="case-title">Кейс 4. Исключение неактивного участника</div>
            <div class="arrow">▾</div>
            <div class="case-content" data-open="0">
                <p>Компания столкнулась с ситуацией...</p>
                <p>Суд обязал участника продать долю...</p>
                <p>После устранения конфликта компания смогла...</p>
            </div>
        </div>

        <!-- Кейс 5 -->
        <div class="case" onclick="toggleCase(this)">
            <div class="case-title">Кейс 5. Восстановление корпоративных прав</div>
            <div class="arrow">▾</div>
            <div class="case-content" data-open="0">
                <p>Учредительница обнаружила поддельные протоколы...</p>
                <p>Судебный процесс включал несколько экспертиз...</p>
                <p>Корпоративные права клиентки восстановлены полностью...</p>
            </div>
        </div>

        <!-- Кейс 6 -->
        <div class="case" onclick="toggleCase(this)">
            <div class="case-title">Кейс 6. Восстановление наследственных прав</div>
            <div class="arrow">▾</div>
            <div class="case-content" data-open="0">
                <p>Наследственная цепочка была нарушена дважды...</p>
                <p>Суд признал наследника принявшим наследство...</p>
                <p>Клиент получил полностью защищённый объект...</p>
            </div>
        </div>

        <!-- Кейс 7 -->
        <div class="case" onclick="toggleCase(this)">
            <div class="case-title">Кейс 7. Остановка незаконного сноса дома</div>
            <div class="arrow">▾</div>
            <div class="case-content" data-open="0">
                <p>После пожара администрация подписала постановление...</p>
                <p>Удалось доказать недопустимость заключения...</p>
                <p>Постановление было отменено, жильцы сохранили квартиры...</p>
            </div>
        </div>

        <!-- Кейс 8 -->
        <div class="case" onclick="toggleCase(this)">
            <div class="case-title">Кейс 8. Защита четырёх жилых домов</div>
            <div class="arrow">▾</div>
            <div class="case-content" data-open="0">
                <p>Собственник построил четыре индивидуальных дома...</p>
                <p>Экспертизы подтвердили соответствие параметрам ИЖС...</p>
                <p>Все суды признали строения законными...</p>
            </div>
        </div>

    </div>
</div>

<script>
// ===== ГИБРИДНЫЙ АВТО-ПЕРЕСЧЁТ ВЫСОТЫ =====

function sendHeight(){
    const height = document.body.scrollHeight;
    window.parent.postMessage({ type: "resize", height: height }, "*");
}

window.addEventListener("load", sendHeight);

new ResizeObserver(() => {
    sendHeight();
}).observe(document.body);

setInterval(() => {
    sendHeight();
}, 350);

// ===== ОТКРЫТИЕ ГЛАВНОГО БЛОКА =====

function toggleMain(){
    let body = document.getElementById("mainBody");

    if(body.dataset.open === "1"){
        body.style.height = "0px";
        body.dataset.open = "0";
    } else {
        body.style.height = "auto";
        body.style.height = body.scrollHeight + "px";
        body.dataset.open = "1";
    }

    sendHeight();
}

// ===== ОТКРЫТИЕ КЕЙСОВ (исправлено) =====

function toggleCase(el){
    el.classList.toggle("active");

    let panel = el.querySelector(".case-content");

    if(panel.dataset.open === "1"){
        panel.style.height = "0px";
        panel.dataset.open = "0";
        sendHeight();
    } else {
        panel.dataset.open = "1";

        // ждём рендер → считаем correct scrollHeight
        requestAnimationFrame(() => {
            panel.style.height = panel.scrollHeight + "px";

            requestAnimationFrame(() => {
                let body = document.getElementById("mainBody");
                body.style.height = "auto";
                body.style.height = body.scrollHeight + "px";
                sendHeight();
            });
        });
    }
}
</script>

</body>
</html>
